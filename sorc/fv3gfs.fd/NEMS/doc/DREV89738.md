DREV89738: HYCOM-GSM-CICE {#milestone_DREV89738}
=========================

\date Last revised: 3/15/2017

Repository URL
--------------

https://svnemc.ncep.noaa.gov/projects/nems/apps/HYCOM-GSM-CICE/trunk

Description
-----------

HYCOM-GSM-CICE 0.1 (DREV89738) is a three-way configuration of the Global Spectral Model (GSM), HYCOM (v2.2.98), and Los Alamos Sea Ice Model (CICE5.0). GSM runs on a T126 grid, and HYCOM and CICE run on a 0.24 degree tripolar global grid.

Field Exchange
--------------

The NEMS mediator receives the model grids at initialization and
creates a decomposition of those grids on the mediator PETs. The
generic NUOPC Connector redistributes the data from the model PETs and
decomposition to the mediator PETs and decomposition. The fields are
transferred on their native model grids. A full set of fields is
transferred among components using the mediator.

| From Mediator to HYCOM | From Mediator to GSM | From Mediator to CICE |
| ---------------------- | -------------------- | --------------------- |
| mean net shortwave flux (including penetrating shortwave flux through the base of sea-ice) | sea surface temperature | atmosphere lowest level height |
| mean downward longwave flux | surface temperature (SST merged with sea ice temperature) | zonal wind velocity at the lowest level height |
| mean upward longwave flux | mean upward longwave flux | meridional wind velocity at the lowest level height |
| zonal momentum flux (including flux from sea ice) | mean latent heat flux | specific humidity at the lowest level height |
| meridional momentum flux (including flux from sea ice) | mean sensible heat flux | air density at the lowest level height |
| sensible heat flux | mean evaporation rate | atmosphere pressure at the lowest level height |
| latent heat flux | zonal momentum flux | air temperature at the lowest level height |
| net heat flux from sea ice | meridional momentum flux | mean downward shortwave flux (vis, dir) |
| net fresh water flux from sea ice | mean ice volume from CICE | mean downward shortwave flux (vis, dif) |
| precipitation rate | mean snow volume from CICE | mean downward shortwave flux (ir, dir) |
| sea ice fraction | sea ice fraction | mean downward shortwave flux (ir, dif) |
| salt flux | sea ice albedo (vis, dir) | mean downward longwave flux |
| &nbsp; | sea ice albedo (vis, dif) | rainfall rate |
| &nbsp; | sea ice albedo (ir, dir) | snowfall rate |
| &nbsp; | sea ice albedo (ir, dif) | freezing/melting potential |
| &nbsp; | &nbsp; | sea surface temperature |
| &nbsp; | &nbsp; | sea surface salinity |
| &nbsp; | &nbsp; | sea surface slope |
| &nbsp; | &nbsp; | zonal ocean current |
| &nbsp; | &nbsp; | meridional ocean current |

Validation
----------

This revision has been run for more than 5 days and exhibits behavior
that is Earth-like. The plots below show SST and sea surface salinity
after 5 days of model integration.

\image html DREV89738-validate-1.png

\image html DREV89738-validate-2.png

Run Sequences
-------------

HYCOM-GSM-CICE includes two run sequences, a cold start sequence and a time integration sequence.

### Cold start sequence

The cold start sequence initializes components using a minimal set of
files needed by GSM. The cold start sequence runs for an hour to
generate restart files for the mediator. There is a fast and a slow
loop, at 15 minutes and 30 minutes, respectively.

    runSeq::
      @1800.0
        @900.0
          MED MedPhase_prep_atm
          MED -> ATM :remapMethod=redist
          ATM
          ATM -> MED :remapMethod=redist
          MED MedPhase_prep_ice
          MED -> ICE :remapMethod=redist
          ICE
          ICE -> MED :remapMethod=redist
          MED MedPhase_atm_ocn_flux
          MED MedPhase_accum_fast
        @
        MED MedPhase_prep_ocn
        MED -> OCN :remapMethod=redist
        OCN
        OCN -> MED :remapMethod=redist
      @
    ::

### Time integration sequence

The time integration sequence is initialized by mediator restart files
generated by the cold start sequence.

    runSeq::
      @1800.0
        MED MedPhase_prep_ocn
        MED -> OCN :remapMethod=redist
        OCN
        @900.0
          MED MedPhase_prep_ice
          MED MedPhase_prep_atm
          MED -> ATM :remapMethod=redist
          MED -> ICE :remapMethod=redist
          ATM
          ICE
          ATM -> MED :remapMethod=redist
          ICE -> MED :remapMethod=redist
          MED MedPhase_atm_ocn_flux
          MED MedPhase_accum_fast
        @
        OCN -> MED :remapMethod=redist
        MED MedPhase_write_restart
      @
    ::

Download, Build, Run, and Restart
=================================

Download and Build
------------------

    svn co -r 89738  https://svnemc.ncep.noaa.gov/projects/nems/apps/HYCOM-GSM-CICE/trunk  work
    cd work/HYCOM/config
    cp Global/Aintelrelo_nems_nuopc  Aintelrelo_nuopc
    cd ../..
    ./NEMS/NEMSAppBuilder
    cp NEMS/exe/NEMS.x  run_dir/NEMS/exe

Cold Start Run and Restart Run
------------------------------

Compsets are located in work/run_dir/NEMS/compsets directory. Compsets that can be run with this revision are:

* `cfsr%20150401_1hr_nems%cold_gsm%slg%T126_cice%0.24_hycom%0.24`
* `cfsr%20150401_1day_nems_gsm%slg%T126_cice%0.24_hycom%0.24`
* `cfsr%20150401_5days_nems_gsm%slg%T126_cice%0.24_hycom%0.24`

To run compsets, start within the run_dir directory and execute
NEMSCompsetRun:

    cd work/run_dir
    ./NEMS/NEMSCompsetRun -compset <compset name>

If you leave off the `-compset` argument, CompsetRun will read the
compset list from a local file called `HYCOM-GSM-CICE.compsetRun`.

To initialize a new case of the HYCOM-GSM-CICE from a cold start, run
the cold start compset,
`cfsr%20150401_1hr_nems%cold_gsm%slg%T126_cice%0.24_hycom%0.24`, to
generate initial mediator restart files. That compset runs the
atm/ice/ocean sequentially for 1 hour. It will generate some initial
mediator restart files consisting of initial values for coupling
fields.

After running the cold start compset, edit `NEMS/NEMSCompsetRun` by
modifying `MED_INPUT_DIR` in "setup_med_nems" to change the location
of the cold start mediator restart files. This will copy the mediator
restart files from your cold start run directory into the new run
directory.

Once the NEMSCompsetRun is modified, run a restart compset like
`cfsr%20150401_1day_nems_gsm%slg%T126_cice%0.24_hycom%0.24` to advance
the model from the initial conditions. The system will start with the
same atmosphere, ocean, and ice initial conditions as the cold start
run plus the new mediator restart files, and the model will run
concurrently.